
@page "/chat/{chatId}"

<RadzenRow>
    <RadzenColumn Size="8">
        <div class="messages" @ref="messagesContainerRef">
            @foreach (var message in Messages)
            {
                <div class="message-container @(MessageContainerClass(message.SenderId))" @oncontextmenu="@(args => ShowContextMenuWithItems(args, message))" @oncontextmenu:preventDefault="true">
                        <div class="sender-name">
                            <RadzenLabel Text="@message.SenderName" />
                        </div>
                        <div class="message-text">
                            <RadzenLabel Text="@message.MessageText" />
                        </div>
                        <div class="creation-time" title="@message.CreatedAt.ToLongDateString()">
                            <RadzenLabel Text="@message.CreatedAt.ToShortTimeString()" />
                        </div>
                    </div>
            }
        </div>

        <div>
            <RadzenTextBox class="message-box" @bind-Value="NewMessage.MessageText" />
            @if (isUpdating)
            {
                <RadzenButton Text="Update" Click="UpdateMessage" />
            }
            else
            {
                <RadzenButton Text="Send" Click="SendMessage" />
            }
        </div>
    </RadzenColumn>
    <RadzenColumn Size="4">

    </RadzenColumn>
</RadzenRow>

<style>
    .messages {
        max-height: 80vh;
        overflow-y: scroll;
    }

    .message-container {
        border: 1px solid #ccc;
        padding: 10px;
        margin-bottom: 10px;
        max-width: 300px;
        border-radius: 8px;
        position: relative;
    }

    .sender-name {
        font-weight: bold;
    }

    .creation-time {
        font-size: 12px;
        color: #666;
        position: absolute;
        bottom: 5px;
        right: 5px;
        opacity: 0.5;
        transition: opacity 0.3s;
    }

    .message-container:hover .creation-time {
        opacity: 1;
    }

    .float-right {
        margin-left: auto;
    }

    .message-box {
        width: 90%;
    }
</style>